# Story 1.2: Rendering Pipeline Optimization (FPS)

## Status
Draft

## Story
As a user collaborating on busy canvases,
I want smooth pan/zoom and object manipulation at 60 FPS,
so that the experience remains fluid even with 500+ objects and multiple users.

## Acceptance Criteria
1. With 500+ objects loaded, median FPS â‰¥ 60 during pan, zoom, and drag scenarios (Chromium + Firefox, production build).
2. Harness gate fails if median FPS < 60; perf report exported to `collabcanvas/test/perf/test-results/`.
3. No regression in shape locking overlays and cursor rendering; overlays remain performant (no visible jank).
4. Diagnostics HUD does not reduce median FPS below 60 when toggled on.

## Tasks / Subtasks
- [ ] Memoize `Shape` components and props (`React.memo`, stable handlers)
- [ ] Introduce Konva layer caching and limit redraw scope
- [ ] Decouple diagnostics HUD updates from core render loop
- [ ] Align drag visual updates with `requestAnimationFrame`
- [ ] Validate via perf harness (500+ objects, 5 users) and store report

## Dev Notes
- Keep single Firestore collection listener invariant from architecture
- Avoid per-shape subscriptions that cause re-render storms
- Ensure overlays (locks, cursors) render in lightweight layers

## Testing
- Run existing unit tests and perf harness
- Validate cross-browser CI matrix (Chromium + Firefox)

## QA Results
_To be completed by QA Agent_


